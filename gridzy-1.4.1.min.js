/**
 * Gridzy v1.4.1
 *
 * Copyright 2019, Helmut Wandl
 */

var Gridzy=function(){"use strict";var n,a,s,o=0,r=null,g={expectArray:function(e){return g.isArraylike(e)?e:[e]},isArraylike:function(e){return e.length===+e.length&&"string"!=typeof e},forceArrayObject:function(e){if(!e)return[];if("toArray"in Object(e))return e.toArray();for(var t=e.length||0,i=new Array(t);t--;)i[t]=e[t];return i},eachOfArray:function(e,t,i){var n;for(n=0;n<e.length;n++)i?t.apply(i,[e[n],n]):t(e[n],n)},domWalk:function(e,t){for(t(e),e=e.firstChild;e;)g.domWalk(e,t),e=e.nextSibling},prependChild:function(e,t){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},indexOfArray:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var i=0,n=e.length;i<n;i++)if(i in e&&e[i]===t)return i;return-1},inArray:function(e,t){return-1!==g.indexOfArray(e,t)},getComputedStyle:window.getComputedStyle?function(e){return getComputedStyle(e)}:function(e){return e.currentStyle},addEventListener:document.addEventListener?function(e,t,i){e.addEventListener(t,i,!1)}:function(t,e,i){t.attachEvent("on"+e,function(e){i.apply(t,[e])})},addClass:document.createElement("div").classList?function(e,t){e.classList.add(t)}:function(e,t){e.className&&-1<e.className.search(new RegExp("(^|\\s+)"+t+"($|\\s+)"))||(e.className=(e.className+" "+t).replace(/\s+/," ").replace(/(^\s+|\s+$)/,""))},removeClass:document.createElement("div").classList?function(e,t){e.classList.remove(t)}:function(e,t){e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"($|\\s+)")," ").replace(/\s+/," ").replace(/(^\s+|\s+$)/,"")},expectNaturalImageSize:(s=[],a=function(){var e;for(e=0;e<s.length;e++)s[e].imgB.width&&s[e].imgB.height&&(void 0===s[e].img.naturalWidth&&(s[e].img.naturalWidth=s[e].imgB.width),void 0===s[e].img.naturalHeight&&(s[e].img.naturalHeight=s[e].imgB.height)),(s[e].img.naturalWidth&&s[e].img.naturalHeight||s[e].ready)&&(s[e].callback(s[e].img,!s[e].error),s.splice(e,1),e--);s.length||(clearInterval(n),n=null)},function(e,t){var i={img:e,callback:t||function(){},imgB:document.createElement("img"),ready:!1,error:!1};g.addEventListener(i.imgB,"load",function(){i.ready=!0}),g.addEventListener(i.imgB,"error",function(){i.ready=!0,i.error=!0}),i.imgB.src=i.img.src,s.push(i),n=n||setInterval(a,0)}),processLazyLoading:function(){if(null!==r){for(var e,t,i,n=r.length,a=Math.max(document.documentElement.clientWidth,window.innerWidth||0),s=Math.max(document.documentElement.clientHeight,window.innerHeight||0),o=[];n--;)t=(e=r[n].image.getBoundingClientRect()).right/(a+(e.right-e.left)),i=e.bottom/(s+(e.bottom-e.top)),-.5<t&&t<1.5&&-.5<i&&i<1.5&&o.push(r.splice(n,1)[0]);for(n=0;n<o.length;n++){g.addClass(o[n].item.element,"gridzyItemLoading"),o[n].item.element.appendChild(o[n].item.progressIndicator);try{o[n].image.naturalWidth=void 0,o[n].image.naturalHeight=void 0}catch(e){}o[n].image.src=o[n].src}}}};function t(e,t){var i=void 0===e.gridzy,n=i?this:e.gridzy,a=0;return(e.gridzy=n)._resetOptionParameters(),i?(n.id=++o,n.itemIdAutoIncrement=0,n._insertQueue={maxQueueTime:1e3,maxQuietTime:400,items:[],lastProcess:null,timer:null},n._forceRecalculateValues=!1,n._updateOptionParameters(t),n._allItems=[],n._validItems=[],n._validItemsOptWidthAll=0,n._validItemsOptionDesiredElementHeight=null,n._validItemsOptionHideBoxOnMissingImage=null,n._element=e,g.addClass(n._element,"gridzyMain"),n._container=document.createElement("div"),n._container.className="gridzyContainer",n._container.style.position="relative",n._container.style.padding="0",n._container.style.border="0",n._container.style.margin="0",n._container.style.display="block",g.prependChild(e,n._container),n.append(e.children),a=n._container.clientWidth,g.addEventListener(window,"resize",function(){n._container.clientWidth!==a&&(a=n._container.clientWidth,n.render())}),g.addEventListener(document,"touchstart",function(){})):n.setOptions(t),n}return t.prototype={setOptions:function(e){this._updateOptionParameters(e),this.render(),g.processLazyLoading()},getOption:function(e){var t=null;switch(typeof this._options[e]){case"function":t=this._options[e](this);break;default:t=this._options[e]}return t},render:function(){var e,t,i,n=this,a=n._calculateGrid(),s=a.rows.length,o=n.getOption("autoFontSize");for(n._options.onBeforeRender(n);s--;)for(i=(e=a.rows[s]).items.length;i--;)(t=e.items[i]).element.style.cssText="position: absolute; width: "+t.displaySizeX+"px; height: "+e.displaySizeY+"px; left: "+t.displayPosX+"px; top: "+e.displayPosY+"px; font-size: "+(o?100*t.displaySizeX/t.size[0]+"%":"100%")+"; ";n._container.style.height=a.size[1]+"px",n._options.onRender(n)},append:function(e){var t,s=this;e=g.forceArrayObject(g.expectArray(e)),-1<(t=g.indexOfArray(e,s._container))&&e.splice(t,1),0===s._insertQueue.items.length&&(s._insertQueue.lastProcess=(new Date).getTime()),g.eachOfArray(e,function(e){e.style.display="block",e.style.visibility="hidden";var a={id:++s.itemIdAutoIncrement,progressIndicator:document.createElement("span"),element:document.createElement("span"),contentElement:e,size:[0,0],ratio:0,failures:!1,status:1,images:[],imagesStatus:[],imagesInfo:[]};g.addClass(a.progressIndicator,"gridzyItemProgressIndicator"),g.addClass(a.element,"gridzyItem"),g.addClass(a.element,"gridzyItemLoading"),a.element.appendChild(a.progressIndicator),a.element.style.position="absolute",a.element.style.visibility="hidden",g.domWalk(e,function(e){if("IMG"===e.nodeName){a.images.push(e);var t=e.getAttribute("width"),i=e.getAttribute("height"),n=e.getAttribute("data-gridzylazysrc");!e.getAttribute("src")&&n&&(t&&i?e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEHAAEALAAAAAABAAEAAAICTAEAOw==":(e.src=n,n=null)),a.imagesInfo.push({styleWidth:e.style.width,styleHeight:e.style.height,attributeWidth:t,attributeHeight:i,lazySrc:n}),null!==t&&null!==i&&0<parseInt(t)&&0<parseInt(i)?a.imagesStatus.push(2):a.imagesStatus.push(1)}}),g.eachOfArray(a.images,function(i,n){function e(){a.imagesStatus[n]=i.naturalWidth?4:0,i.naturalWidth||g.expectNaturalImageSize(i,function(e,t){a.imagesStatus[n]=t&&i.naturalWidth?i.complete?4:3:0,s._onImageReady(a)}),s._onImageFinished(a)}g.addEventListener(i,"load",e),g.addEventListener(i,"error",function(){a.imagesStatus[n]=0,s._onImageFinished(a)}),i.complete&&e(),a.imagesInfo[n].lazySrc||g.expectNaturalImageSize(i,function(e,t){a.imagesStatus[n]=t&&i.naturalWidth?i.complete?4:3:0,s._onImageReady(a)})}),s._allItems.push(a),s._container.appendChild(a.element),s._onImageReady(a),s._onImageFinished(a)})},_processInsertQueue:function(e){var t,i,n,a,s,o,r=this,l=r._insertQueue.lastProcess<(new Date).getTime()-r._insertQueue.maxQueueTime,d=[],u=[],m=r.getOption("preventInitialAnimation"),c=[];if(null!==r._insertQueue.timer&&(clearTimeout(r._insertQueue.timer),r._insertQueue.timer=null),e||l){for(t=r._insertQueue.items.shift();t;)u.push(t),g.prependChild(t.item.element,t.contentElement),t=r._insertQueue.items.shift();for(o=u.length;o--;)for(a=(t=u[o]).item.images.length;a--;)!(n=t.item.imagesInfo[a]).attributeWidth&&t.item.images[a].offsetWidth<40&&t.item.images[a].naturalWidth&&(n.attributeWidth=t.item.images[a].naturalWidth),!n.attributeHeight&&t.item.images[a].offsetHeight<40&&t.item.images[a].naturalHeight&&(n.attributeHeight=t.item.images[a].naturalHeight),(n.attributeWidth||n.attributeHeight)&&(s=g.getComputedStyle(t.item.images[a]),(parseInt(s.width)<40||"auto"===s.width||n.lazySrc)&&n.attributeWidth&&!n.styleWidth&&d.push({image:t.item.images[a],definition:"width",value:n.attributeWidth+"px"}),(parseInt(s.height)<40||"auto"===s.height||n.lazySrc)&&n.attributeHeight&&!n.styleHeight&&d.push({image:t.item.images[a],definition:"height",value:n.attributeHeight+"px"})),n.lazySrc&&c.push({item:t.item,image:t.item.images[a],src:n.lazySrc});for(i=d.length;i--;)d[i].image.style[d[i].definition]=d[i].value,d[i].image.style.display="none";for(document.body.offsetWidth,i=d.length;i--;)d[i].image.style.display="";for(o=u.length;o--;)(t=u[o]).item.size=[t.contentElement.offsetWidth,t.contentElement.offsetHeight],t.item.ratio=t.item.size[0]/t.item.size[1];for(i=d.length;i--;)d[i].image.style[d[i].definition]="";for(o=u.length;o--;)t=u[o],g.addClass(t.contentElement,"gridzyItemContent"),t.contentElement.style.width="100%",t.contentElement.style.height="100%",t.item.status=3;for(m&&(r._element.className=r._element.className.replace(/(^|\s)gridzyAnimated(\s|$)/,"$1gridzyAnimatedOnLoad$2")),r._forceRecalculateValues=!0,r.render(),m&&(document.body.offsetWidth,r._element.className=r._element.className.replace(/(^|\s)gridzyAnimatedOnLoad(\s|$)/,"$1gridzyAnimated$2")),o=u.length;o--;)(t=u[o]).item.element.style.visibility="",t.item.contentElement.style.visibility="";c.length&&r._addImagesToLazyLoadQueue(c),r._insertQueue.lastProcess=(new Date).getTime()}else r._insertQueue.timer=setTimeout(function(){r._processInsertQueue(!0)},r._insertQueue.maxQuietTime)},_addImagesToLazyLoadQueue:function(e){null===r&&e.length&&(r=[],g.addEventListener(window,"resize",g.processLazyLoading),g.addEventListener(window,"scroll",g.processLazyLoading)),r=r.concat(e),g.processLazyLoading()},_addToInsertQueue:function(e,t){this._insertQueue.items.push({contentElement:e,item:t}),this._processInsertQueue(!1)},_onImageFinished:function(e){var t=e.failures;g.inArray(e.imagesStatus,1)||g.inArray(e.imagesStatus,2)||g.inArray(e.imagesStatus,3)||(g.inArray(e.imagesStatus,0)&&(e.failures=!0),3===e.status&&t!==e.failures&&(this._forceRecalculateValues=!0,this.render()),g.removeClass(e.element,"gridzyItemLoading"),e.progressIndicator&&e.progressIndicator.parentNode&&e.progressIndicator.parentNode===e.element&&e.element.removeChild(e.progressIndicator))},_onImageReady:function(e){var t=e.failures;g.inArray(e.imagesStatus,0)?e.failures=!0:e.failures=!1,3===e.status&&t!==e.failures&&(this._forceRecalculateValues=!0,this.render()),1!==e.status||g.inArray(e.imagesStatus,1)||(e.status=2,this._addToInsertQueue(e.contentElement,e))},_resetOptionParameters:function(){this._options={fillLastRow:!0,fillSingleRow:!0,spaceBetweenElements:1,desiredElementHeight:200,autoFontSize:!1,hideBoxOnMissingImage:!0,preventInitialAnimation:!1,onBeforeOptionsChanged:function(){},onOptionsChanged:function(){},onBeforeRender:function(){},onRender:function(){}}},_updateOptionParameters:function(e){var t=this;e=e||{},t._options.onBeforeOptionsChanged(t),void 0!==e.fillLastRow&&(t._options.fillLastRow="function"==typeof e.fillLastRow?e.fillLastRow:!!e.fillLastRow),void 0!==e.fillSingleRow&&(t._options.fillSingleRow="function"==typeof e.fillSingleRow?e.fillSingleRow:!!e.fillSingleRow),void 0!==e.spaceBetweenElements&&(t._options.spaceBetweenElements="function"==typeof e.spaceBetweenElements?e.spaceBetweenElements:+e.spaceBetweenElements),void 0!==e.desiredElementHeight&&(t._options.desiredElementHeight="function"==typeof e.desiredElementHeight?e.desiredElementHeight:+e.desiredElementHeight),void 0!==e.autoFontSize&&(t._options.autoFontSize="function"==typeof e.autoFontSize?e.autoFontSize:!!e.autoFontSize),void 0!==e.hideBoxOnMissingImage&&(t._options.hideBoxOnMissingImage="function"==typeof e.hideBoxOnMissingImage?e.hideBoxOnMissingImage:!!e.hideBoxOnMissingImage),void 0!==e.preventInitialAnimation&&(t._options.preventInitialAnimation="function"==typeof e.preventInitialAnimation?e.preventInitialAnimation:!!e.preventInitialAnimation),"function"==typeof e.onBeforeOptionsChanged&&(t._options.onBeforeOptionsChanged=e.onBeforeOptionsChanged),"function"==typeof e.onOptionsChanged&&(t._options.onOptionsChanged=e.onOptionsChanged),"function"==typeof e.onBeforeRender&&(t._options.onBeforeRender=e.onBeforeRender),"function"==typeof e.onRender&&(t._options.onRender=e.onRender),t._options.onOptionsChanged(t)},_precalculateValues:function(e){var t,i=this,n=i._allItems,a=[],s=0,o=n.length,r=i.getOption("desiredElementHeight"),l=i.getOption("hideBoxOnMissingImage");if(!e||i._validItemsOptionDesiredElementHeight!==r||i._validItemsOptionHideBoxOnMissingImage!==l){for(;o--;)3===(t=n[o]).status&&(l&&t.failures?t.element.style.display="none":t.size[0]&&t.size[1]&&(t.element.style.display="",a.unshift(t),t.optWidth=r*t.size[0]/t.size[1],s+=t.optWidth));i._validItemsOptionDesiredElementHeight=r,i._validItemsOptionHideBoxOnMissingImage=l,i._validItems=a,i._validItemsOptWidthAll=s,i._forceRecalculateValues=!1}},_calculateGrid:function(){var e,t,i,n,a,s,o,r,l,d,u,m,c,g=this,h=g.getOption("spaceBetweenElements"),p=g._container.clientWidth,f=0,y={rows:[],size:[p,0]},_=y.rows,v=0,I=0,A=g.getOption("fillLastRow"),z=g.getOption("fillSingleRow");for(this._precalculateValues(!this._forceRecalculateValues),n=(i=g._validItems).length,s=g._validItemsOptWidthAll,o=A?s/(Math.round((s+h*n)/(p+h))||1):p,e=n;e--;)a=i[n-1-e],(void 0===l||f+a.optWidth/2>o*_.length)&&_.push(l={displaySizeY:0,displayPosY:0,ratioAll:0,optWidth:0,items:[]}),f+=a.optWidth,l.optWidth+=a.optWidth,l.ratioAll+=a.ratio,l.items.push(a);for(r=_.length,u=null,e=0;e<r;e++){for(I=v=0,m=p-((d=(l=_[e]).items.length)-1)*h,c=1===r&&z||1<r&&A||e<r-1||l.optWidth>=m,t=0;t<d;t++)(a=l.items[t]).displayPosX=v+t*h,a.displaySizeX=c?Math.round(a.ratio/l.ratioAll*m):Math.round(a.optWidth),v+=a.displaySizeX,c&&t===d-1&&v!==m&&(a.displaySizeX+=m-v),I+=a.displaySizeX/a.ratio;l.displaySizeY=Math.round(I/d),l.displayPosY=u?u.displayPosY+u.displaySizeY+h:0,y.size[1]+=l.displaySizeY+(e?h:0),u=l}return y}},"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.gridzy=function(e){return this.each(function(){jQuery(this).data("gridzy",new t(this,e))})}),t}();